# =============================================================================
# Railway deployment configuration
# https://docs.railway.app/reference/config-as-code
#
# Services in this project
# ─────────────────────────
#  backend   FastAPI + Celery worker (combined, start.sh)
#
# Hosted elsewhere
#  • web      Vercel (Next.js)  — set NEXT_PUBLIC_API_URL to backend URL
#
# External services (provisioned manually)
#  • Supabase  https://supabase.com  — Postgres + Auth + Storage
#  • Redis     Railway plugin        — add via Railway dashboard (auto-sets REDIS_URL)
# =============================================================================

[build]
builder = "dockerfile"

# ---------------------------------------------------------------------------
# Backend  (FastAPI + Celery worker in one container)
# ---------------------------------------------------------------------------
[[services]]
name = "backend"

[services.build]
dockerfilePath = "Dockerfile"
buildContext    = "."

[services.deploy]
healthcheckPath        = "/health"
healthcheckTimeout     = 30
restartPolicyType      = "on_failure"
restartPolicyMaxRetries = 3
